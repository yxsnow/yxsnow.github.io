import{_ as n,r as i,o as s,c as o,b as e,d as t,e as l,a as r}from"./app-ff2f634e.js";const d="/assets/1734894ee7aaf2b6_tplv-t2oaga2asx_2e5a8010c5bb40479-d990592e.webp",h="/assets/173489db13875e5b_tplv-t2oaga2asx_5a886d2a22c041199-c05deabe.webp",c={},u=r('<p>RAIL是一个以用户为中心的性能模型，它把用户的体验拆分成几个关键点（例如，tap，scroll，load），并且帮你定义好了每一个的性能指标。</p><p>有以下四个方面：</p><ul><li>Response</li><li>Animation</li><li>Idle</li><li>Load</li></ul><img width="676" height="245" src="'+d+'"><h2 id="聚焦用户" tabindex="-1"><a class="header-anchor" href="#聚焦用户" aria-hidden="true">#</a> 聚焦用户</h2><p>以下是用户对性能延迟的感知：</p><table><thead><tr><th>延迟时间</th><th>用户感知</th></tr></thead><tbody><tr><td>0-16ms</td><td>很流畅</td></tr><tr><td>0-100ms</td><td>基本流畅</td></tr><tr><td>100-1000ms</td><td>感觉到网站上有一些加载任务</td></tr><tr><td>1000ms or more</td><td>失去耐心了</td></tr><tr><td>10000ms or more</td><td>直接离开，不会再访问了</td></tr></tbody></table><h2 id="response-事件处理最好在50ms内完成" tabindex="-1"><a class="header-anchor" href="#response-事件处理最好在50ms内完成" aria-hidden="true">#</a> Response: 事件处理最好在50ms内完成</h2><h3 id="目标" tabindex="-1"><a class="header-anchor" href="#目标" aria-hidden="true">#</a> 目标</h3><ul><li>用户的输入到响应的时间不超过100ms，给用户的感受是瞬间就完成了。</li></ul><h3 id="优化方案" tabindex="-1"><a class="header-anchor" href="#优化方案" aria-hidden="true">#</a> 优化方案</h3><ul><li>事件处理函数在50ms内完成，考虑到idle task的情况，事件会排队，等待时间大概在50ms。适用于click，toggle，starting animations等，不适用于drag和scroll。</li><li>复杂的js计算尽可能放在后台，如web worker，避免对用户输入造成阻塞</li><li>超过50ms的响应，一定要提供反馈，比如倒计时，进度百分比等。</li></ul><blockquote><p>idle task：除了要处理输入事件，浏览器还有其它任务要做，这些任务会占用部分时间，一般情况会花费50ms的时间，输入事件的响应则排在其后。</p></blockquote><p>下图是idle task对input response的影响：</p><img width="676" height="338" src="'+h+'"><h2 id="animation-在10ms内产生一帧" tabindex="-1"><a class="header-anchor" href="#animation-在10ms内产生一帧" aria-hidden="true">#</a> Animation: 在10ms内产生一帧</h2><h3 id="目标-1" tabindex="-1"><a class="header-anchor" href="#目标-1" aria-hidden="true">#</a> 目标</h3><ul><li>产生每一帧的时间不要超过10ms，为了保证浏览器60帧，每一帧的时间在16ms左右，但浏览器需要用6ms来渲染每一帧。</li><li>旨在视觉上的平滑。用户对帧率变化感知很敏感。</li></ul><h3 id="优化方案-1" tabindex="-1"><a class="header-anchor" href="#优化方案-1" aria-hidden="true">#</a> 优化方案</h3><ul><li>在一些高压点上，比如动画，不要去挑战cpu，尽可能地少做事，如：取offset，设置style等操作。尽可能地保证60帧的体验。</li><li>在渲染性能上，针对不同的动画做一些特定优化</li></ul><blockquote><p>动画不只是UI的视觉效果，以下行为都属于</p><ul><li>视觉动画，如渐隐渐显，tweens，loading等</li><li>滚动，包含弹性滚动，松开手指后，滚动会持续一段距离</li><li>拖拽，缩放，经常伴随着用户行为</li></ul></blockquote><h2 id="idle-最大化空闲时间" tabindex="-1"><a class="header-anchor" href="#idle-最大化空闲时间" aria-hidden="true">#</a> Idle: 最大化空闲时间</h2><h3 id="目标-2" tabindex="-1"><a class="header-anchor" href="#目标-2" aria-hidden="true">#</a> 目标</h3><ul><li>最大化空闲时间，以增大50ms内响应用户输入的几率</li></ul><h3 id="优化方案-2" tabindex="-1"><a class="header-anchor" href="#优化方案-2" aria-hidden="true">#</a> 优化方案</h3>',25),p={href:"https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FWindow%2FrequestIdleCallback",title:"https://developer.mozilla.org/en-US/docs/Web/API/Window/requestIdleCallback",target:"_blank",rel:"noopener noreferrer"},_=e("li",null,"在空闲时间内执行的任务尽量控制在50ms以内，如果更长的话，会影响input handle的pending时间",-1),b=e("li",null,"如果用户在空闲时间任务进行时进行交互，必须以此为最高优先级，并暂停空闲时间的任务",-1),g=r('<h2 id="load-传输内容到页面可交互的时间不超过5秒" tabindex="-1"><a class="header-anchor" href="#load-传输内容到页面可交互的时间不超过5秒" aria-hidden="true">#</a> Load: 传输内容到页面可交互的时间不超过5秒</h2><p>如果页面加载比较慢，用户的交点可能会离开。加载很快的页面，用户平均停留时间会变长，跳出率会更低，也就有更高的广告查看率</p><h3 id="目标-3" tabindex="-1"><a class="header-anchor" href="#目标-3" aria-hidden="true">#</a> 目标</h3><ul><li>优化加载速度，可以根据设备、网络等条件。目前，比较好的一个方式是，让你的页面在一个中配的3G网络手机上打开时间不超过5秒</li><li>对于第二次打开，尽量不超过2秒</li></ul><h3 id="优化方案-3" tabindex="-1"><a class="header-anchor" href="#优化方案-3" aria-hidden="true">#</a> 优化方案</h3>',5),m={href:"https://link.juejin.cn?target=https%3A%2F%2Fwww.webpagetest.org%2Feasy",title:"https://www.webpagetest.org/easy",target:"_blank",rel:"noopener noreferrer"},f=e("li",null,"要注意的是，即使用户的网络是4G，但因为丢包或者网络波动，可能会比预期的更慢",-1),F={href:"https://link.juejin.cn?target=https%3A%2F%2Fweb.dev%2Frender-blocking-resources%2F",title:"https://web.dev/render-blocking-resources/",target:"_blank",rel:"noopener noreferrer"},k={href:"https://link.juejin.cn?target=https%3A%2F%2Fweb.dev%2Fnative-lazy-loading%2F",title:"https://web.dev/native-lazy-loading/",target:"_blank",rel:"noopener noreferrer"},w={href:"https://link.juejin.cn?target=https%3A%2F%2Fweb.dev%2Freduce-javascript-payloads-with-code-splitting%2F",title:"https://web.dev/reduce-javascript-payloads-with-code-splitting/",target:"_blank",rel:"noopener noreferrer"},x={href:"https://link.juejin.cn?target=https%3A%2F%2Fweb.dev%2Ffast%2F",title:"https://web.dev/fast/",target:"_blank",rel:"noopener noreferrer"},v=e("h2",{id:"分析rail用的工具",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#分析rail用的工具","aria-hidden":"true"},"#"),t(" 分析RAIL用的工具")],-1),j={href:"https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.google.com%2Fweb%2Ftools%2Fchrome-devtools",title:"https://developers.google.com/web/tools/chrome-devtools",target:"_blank",rel:"noopener noreferrer"},A={href:"https://link.juejin.cn?target=https%3A%2F%2Fweb.dev%2Fmeasure%2F",title:"https://web.dev/measure/",target:"_blank",rel:"noopener noreferrer"},y={href:"https://link.juejin.cn?target=https%3A%2F%2Fwebpagetest.org%2Feasy",title:"https://webpagetest.org/easy",target:"_blank",rel:"noopener noreferrer"},I=e("h2",{id:"总结",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#总结","aria-hidden":"true"},"#"),t(" 总结")],-1),L=e("p",null,"RAIL是一个旅程，为了提升用户在网站的交互体验而不断探索。你需要去理解用户如何感知你的站点，这样才能设置最佳的性能目标",-1),q=e("ul",null,[e("li",null,"聚焦用户"),e("li",null,"100ms内响应用户的输入"),e("li",null,"10ms内产生1帧，在滚动或者动画执行时"),e("li",null,"最大化主线程的空闲时间"),e("li",null,"5s内让网页变得可交互")],-1);function R(T,W){const a=i("ExternalLinkIcon");return s(),o("div",null,[u,e("ul",null,[e("li",null,[t("用空闲时间来完成一些延后的工作，如先加载页面可见的部分，然后利用空闲时间加载剩余部分，此处可以使用 "),e("a",p,[t("requestIdleCallback API"),l(a)])]),_,b]),g,e("ul",null,[e("li",null,[t("在手机设备上测试加载性能，选用中配的3G网络（400kb/s，400ms RTT），可以使用 "),e("a",m,[t("WebPageTest"),l(a)]),t(" 来测试")]),f,e("li",null,[e("a",F,[t("禁用渲染阻塞的资源，延后加载"),l(a)])]),e("li",null,[t("可以采用 "),e("a",k,[t("lazy load"),l(a)]),t("，"),e("a",w,[t("code-splitting"),l(a)]),t(" 等 "),e("a",x,[t("其他优化"),l(a)]),t(" 手段，让第一次加载的资源更少")])]),v,e("ul",null,[e("li",null,[e("a",j,[t("Chrome DevTools"),l(a)])]),e("li",null,[e("a",A,[t("Lighthouse"),l(a)])]),e("li",null,[e("a",y,[t("WebPageTest"),l(a)])])]),I,L,q])}const C=n(c,[["render",R],["__file","qianduanxingnenyouhua - yongRAILmoxingfenxixingnen.html.vue"]]);export{C as default};
